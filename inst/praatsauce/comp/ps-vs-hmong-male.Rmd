---
title: 'PraatSauce/VoiceSauce comparison: White Hmong (male speaker)'
author: "James Kirby"
date: "31/01/2018"
output:
  pdf_document:
    toc: yes
    toc_depth: '3'
  html_document:
    toc: yes
    toc_depth: 3
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, cache = TRUE)
require(ggplot2)
require(plyr)
require(tidyr)
require(stringr)
library(scales)
theme_set(theme_bw())
```

```{r include=FALSE}

######################
## VoiceSauce 
######################

## VoiceSauce columns we care about
keeps <- c('Filename', 'Label', 'Item', 'seg_Start', 'seg_End', 't_ms', 'H1c', 'H2c', 'H4c', 'A1c', 'A2c', 'A3c', 'H1u', 'H2u', 'H4u', 'A1u', 'A2u', 'A3u', 'H2Ku', 'H5Ku', 'CPP', 'HNR05', 'HNR15', 'HNR25', 'HNR35', 'H1H2u', 'H2H4u', 'H1A1u', 'H1A2u', 'H1A3u', 'H1H2c', 'H2H4c', 'H1A1c', 'H1A2c', 'H1A3c', 'H2KH5Ku', 'strF0', 'sF0', 'pF0', 'sF1', 'sF2', 'sF3', 'pF1', 'pF2', 'pF3', 'pB1', 'pB2', 'pB3', 'sB1', 'sB2', 'sB3')

## VoiceSauce, formula bandwidths
vs.fbw <- read.csv('/Users/jkirby/Documents/Projects/praatsauce/comp/hmong_male_voicesauce_formulabw.txt', sep='\t')
## get rid of .mat extention
vs.fbw$Filename <- gsub('.mat', '', vs.fbw$Filename)
vs.fbw <- vs.fbw %>% separate(Filename, c("Num", "Item", "Junk"), "-", remove=FALSE)
vs.fbw <- vs.fbw[keeps]

## scaled time
vs.fbw<-ddply(vs.fbw, .(Filename), mutate, t=rescale(t_ms))

vs.fbw$method = rep("formula")
vs.fbw$script = rep("VoiceSauce")
vs.fbw.long <- gather(vs.fbw, measure, value, H1c:sB3, factor_key=TRUE)        

## VoiceSauce, estimated bandwidths (maybe)
vs.ebw <- read.csv('/Users/jkirby/Documents/Projects/praatsauce/comp/hmong_male_voicesauce_estbw.txt', sep='\t')
## get rid of .mat extention
vs.ebw$Filename <- gsub('.mat', '', vs.ebw$Filename)
vs.ebw <- vs.ebw %>% separate(Filename, c("Num", "Item", "Junk"), "-", remove=FALSE)
vs.ebw <- vs.ebw[keeps]

## scaled time
vs.ebw<-ddply(vs.ebw, .(Filename), mutate, t=rescale(t_ms))

vs.ebw$method = rep("estimated")
vs.ebw$script = rep("VoiceSauce")
vs.ebw.long <- gather(vs.ebw, measure, value, H1c:sB3, factor_key=TRUE)        


######################
## PraatSauce
######################

## symmetric kernel
f21 <- rep(1/21,21)
## lag kernel
f20 <- rep(1/20,20)

## formula bandwidths
ps.fbw <- read.csv('/Users/jkirby/Documents/Projects/praatsauce/comp/hmong_male_praatsauce_formulabw.txt', header=TRUE)
## turn into msec
ps.fbw$seg_Start <- ps.fbw$seg_Start * 1000
ps.fbw$seg_End <- ps.fbw$seg_End* 1000
ps.fbw$t_ms <- ps.fbw$t_ms* 1000
drops <- c('t', 'var1', 'var3')
ps.fbw <- ps.fbw[, !(names(ps.fbw) %in% drops)]

names(ps.fbw) <- c('Filename', 'Item', 'Label', 'seg_Start', 'seg_End', 't_ms', 'pF0', 'pF1', 'pF2', 'pF3', 'pB1', 'pB2', 'pB3', 'H1u', 'H2u', 'H4u', 'H2Ku', 'H5Ku', 'A1u','A2u', 'A3u', 'H1H2u', 'H2H4u', 'H1A1u', 'H1A2u', 'H1A3u', 'H2KH5Ku', 'H1c', 'H2c', 'H4c', 'A1c', 'A2c', 'A3c', 'H1H2c', 'H2H4c', 'H1A1c', 'H1A2c', 'H1A3c', 'CPP', 'HNR05', 'HNR15', 'HNR25',  'HNR35')

## remove zeros
ps.fbw[ps.fbw == 0] <- NA

## smoothing
#ps.fbw <- cbind(ps.fbw[1:6], apply(ps.fbw[7:43], 2, filter, filter=f21, sides=2))

## scaled time
ps.fbw<-ddply(ps.fbw, .(Filename), mutate, t=rescale(t_ms))

ps.fbw$method = rep("formula")
ps.fbw$script = rep("PraatSauce")
ps.fbw.long <- gather(ps.fbw, measure, value, pF0:HNR35, factor_key=TRUE)

## estimated bandwidths
ps.ebw <- read.csv('/Users/jkirby/Documents/Projects/praatsauce/comp/hmong_male_praatsauce_estbw.txt', header=TRUE)
## turn into msec
ps.ebw$seg_Start <- ps.ebw$seg_Start * 1000
ps.ebw$seg_End <- ps.ebw$seg_End* 1000
ps.ebw$t_ms <- ps.ebw$t_ms* 1000
ps.ebw <- ps.ebw[, !(names(ps.ebw) %in% drops)]

names(ps.ebw) <- c('Filename', 'Item', 'Label', 'seg_Start', 'seg_End', 't_ms', 'pF0', 'pF1', 'pF2', 'pF3', 'pB1', 'pB2', 'pB3', 'H1u', 'H2u', 'H4u', 'H2Ku', 'H5Ku', 'A1u','A2u', 'A3u', 'H1H2u', 'H2H4u', 'H1A1u', 'H1A2u', 'H1A3u', 'H2KH5Ku', 'H1c', 'H2c', 'H4c', 'A1c', 'A2c', 'A3c', 'H1H2c', 'H2H4c', 'H1A1c', 'H1A2c', 'H1A3c', 'CPP', 'HNR05', 'HNR15', 'HNR25',  'HNR35')

## remove zero
ps.ebw[ps.ebw == 0] <- NA

## smoothing
#ps.ebw <- cbind(ps.ebw[1:6], apply(ps.ebw[7:43], 2, filter, filter=f21, sides=2))

## scale
ps.ebw<-ddply(ps.ebw, .(Filename), mutate, t=rescale(t_ms))

ps.ebw$method = rep("estimated")
ps.ebw$script = rep("PraatSauce")

ps.ebw.long <- gather(ps.ebw, measure, value, pF0:HNR35, factor_key=TRUE)

## combine
df <- rbind(ps.fbw.long,ps.ebw.long,vs.fbw.long,vs.ebw.long)

df$corrected <- rep('uncorrected')
df[df$measure %in% c('H1c', 'H2c', 'H4c', 'A1c', 'A2c', 'A3c', 'H1H2c', 'H2H4c', 'H1A1c', 'H1A2c', 'H1A3c'),]$corrected <- 'corrected'
```


## Data

This small dataset compares spectral measures generated by both PraatSauce v0.2.2 and VoiceSauce v1.31 at 1 msec intervals for 9 White Hmong lexical items spoken by a single male speaker. The original audio files can be found [here](http://www.phonetics.ucla.edu/voiceproject/voice.html). For both scripts, 5 formants were estimated with a maximum formant frequency of 5000 Hz; minimum and maximum F0 values were set to 50 Hz and 300 Hz for all F0 estimators. For VoiceSauce, the STRAIGHT F0 estimate and Snack formant/bandwidth estimates were used for harmonic amplitude corrections.

The `method` column indicates whether the formant bandwidths were `estimated` using Praat (PraatSauce) or Snack (VoiceSauce), or whether the Hawks and Miller `formula` was used.

Note that in Hmong orthography, final *-g* indicates a low-falling breathy tone, while *-m* indicates a creaky tone.

```{r}
head(df)
```

In the plots which follow, the PraatSauce measures are unsmoothed. If you want to compare to smoothed estimates, uncomment the two lines:

```{r, execture=FALSE}
ps.fbw <- cbind(ps.fbw[1:6], apply(ps.fbw[7:43], 2, filter, filter=f21, sides=2))
ps.ebw <- cbind(ps.ebw[1:6], apply(ps.ebw[7:43], 2, filter, filter=f21, sides=2))
```

This implements a symmetric kernel filter. This is different from what VoiceSauce does. VoiceSauce uses the Matlab `filter()` function, by default a lag filter which pads with zeros. So while the smoothed value of sample 20 is equal to $\sum_{i=1}^{20}/20$, the smoothed value of sample 19 is not undefined, but is calculated as $\sum_{i=1}^{19}/20$, the smoothed value of sample 18 is $\sum_{i=1}^{18}/20$, etc.

If you want to smooth the Matlab way, use the lag kernel by selecting `filter=f20` and set `sides=1`.

## Plots

### F0

```{r, echo=FALSE}
ggplot(subset(df, value > 0 & method == 'formula' & measure %in% c('strF0', 'pF0', 'sF0')), aes(t_ms, value, colour=measure, linetype=script, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Filename, scales='free') 
```

STRAIGHT appears to be capturing CF0 effects that most other estimators or not. This is an example of where pitch settings can be important: if the default PraatSauce pitch settings are used (40 Hz and 600 Hz), PraatSauce consistently fails to detect the initial F0 perturbations. 

\newpage
### Formants

#### Formants estimate using Praat
```{r, echo=FALSE}
ggplot(subset(df, method == 'estimated' & measure %in% c('pF1', 'pF2', 'pF3')), aes(t_ms, value, colour=measure, linetype=script, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Filename, scales='free') 
```

\newpage
#### Formants estimated using Snack (VoiceSauce) vs. Praat (PraatSauce)
```{r, echo=FALSE}
ggplot(subset(df, (script=='PraatSauce' & method == 'estimated' & measure %in% c('pF1', 'pF2', 'pF3')) | (script=='VoiceSauce' & method == 'estimated' & measure %in% c('sF1', 'sF2', 'sF3'))), aes(t_ms, value, colour=measure, linetype=script, group=interaction(method,measure, script))) + geom_line() + facet_wrap(~Filename, scales='free') + scale_color_manual(values=c(c(hue_pal()(3)), c(hue_pal()(3)))) 
```

There are a few difference, especially at edges, some of which may be due to smoothing. However, it's not clear why the Praat-based estimates aren't identical: both scripts use the exact same command, with the same parameters, to estimate the formants (and bandwidths).

\newpage
### Bandwidths

#### PraatSauce estimated vs. formula bandwidths 

```{r, echo=FALSE}
ggplot(subset(df, script=='PraatSauce' & measure %in% c('pB1', 'pB2', 'pB3')), aes(t_ms, value, colour=measure, linetype=method, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Filename, scales='free')
```

PraatSauce estimated bandwidths are huge...

\newpage
#### PraatSauce vs. VoiceSauce estimated bandwidths

```{r, echo=FALSE}

ggplot(subset(df, method == 'estimated' & measure %in% c('pB1', 'pB2', 'pB3')), aes(t_ms, value, colour=measure, linetype=script, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Filename, scales='free')
```

... but VoiceSauce Praat-estimated bandwidths are frequently an order of magnitude huger.

\newpage
#### VoiceSauce Praat vs. Snack estimated bandwidths

```{r, echo=FALSE}
ggplot(subset(df, method == 'estimated' & script=='VoiceSauce' & measure %in% c('pB1', 'pB2', 'pB3', 'sB1', 'sB2', 'sB3')), aes(t_ms, value, colour=measure, linetype=measure, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Filename, scales='free') + scale_linetype_manual(values=c('solid', 'solid', 'solid', 'dashed', 'dashed', 'dashed')) + scale_color_manual(values=c(c(hue_pal()(3)), c(hue_pal()(3))))
```

VoiceSauce's Snack estimates (if that's really what they are) look less erratic.

\newpage
####  VoiceSauce Snack vs. PraatSauce estimated bandwidths 

```{r, echo=FALSE}
ggplot(subset(df, method == 'estimated' & (script=='PraatSauce' & measure %in% c('pB1', 'pB2', 'pB3')) | (script == 'VoiceSauce' & measure %in% c('sB1', 'sB2', 'sB3'))), aes(t_ms, value, colour=measure, linetype=script, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Filename, scales='free') + scale_color_manual(values=c(c(hue_pal()(3)), c(hue_pal()(3))))
```

Once again, the degree of overlap between PS-Praat and VS-Snack makes me wonder if the VS estimates aren't getting reversed somehow in the output, though I can't find any obvious evidence that this is the case in the VS code. However, it does appear that the way VS "uses" Praat formant estimates to estimate bandwidths is by taking the formant estimate and applying the Mannell (1998) formula 

$$
b_i = 80 + 120f_i / 5000
$$

while PraatSauce uses Praat's estimates of formant bandwidths, which appear to be a fixed function based on the frequencies of the adjacent formants.

\newpage
### Uncorrected amplitudes

#### PraatSauce vs. VoiceSauce uncorrected H1, H2, H4
Note that the choice of bandwidth estimator is irrelevant here.

```{r, echo=FALSE}
ggplot(subset(df, method == 'formula' & measure %in% c('H1u', 'H2u', 'H4u')), aes(t_ms, value, colour=measure, linetype=script, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Filename, scales="free_x")
```

\newpage
#### PraatSauce vs. VoiceSauce uncorrected A1, A2, A3

```{r, echo=FALSE}
ggplot(subset(df, method == 'formula' & measure %in% c('A1u', 'A2u', 'A3u')), aes(t_ms, value, colour=measure, linetype=script, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Filename, scales='free_x') 
```

VoiceSauce estimates are consistently 20-25 dB lower than the PraatSauce estimates, and are sometimes negative, which seems...strange. This suggests to me they are being attenuated somewhere, though I have not been able to find the piece of code where this happens.

\newpage
### Corrected amplitudes

Here, choice of formant bandwidth estimator potentially matters.

In these plots, PraatSauce is using Praat and VoiceSauce is using Snack estimates.

#### PraatSauce vs. VoiceSauce H1\*, H2\*, H4\*

```{r, echo=FALSE}
ggplot(subset(df, method=='estimated' & measure %in% c('H1c', 'H2c', 'H4c')), aes(t_ms, value, colour=measure, linetype=script, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Filename, scales="free_x") + ggtitle("Estimated bandwidths")
```

\newpage

```{r, echo=FALSE}
ggplot(subset(df, method == 'formula' & measure %in% c('H1c', 'H2c', 'H4c')), aes(t_ms, value, colour=measure, linetype=script, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Filename, scales="free_x") +ggtitle("Formula bandwidths")
```

For VoiceSauce, using estimated bandwidths is virtually unnoticeable:

\newpage
#### VoiceSauce estimated vs. formula bandwidths, H1\*, H2\*, H4\*

```{r, echo=FALSE}
ggplot(subset(df, script=='VoiceSauce' & measure %in% c('H1c', 'H2c', 'H4c')), aes(t_ms, value, colour=measure, linetype=method, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Filename, scales="free_x") 
```

For PraatSauce, using the formula bandwidths makes only very minor differences:

\newpage
#### PraatSauce estimated vs. formula bandwidths, H1\*, H2\*, H4\*

```{r, echo=FALSE}
ggplot(subset(df, script=='PraatSauce' & measure %in% c('H1c', 'H2c', 'H4c')), aes(t_ms, value, colour=measure, linetype=method, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Filename, scales="free_x") 
```

\newpage
#### PraatSauce vs. VoiceSauce A1\*, A2\*, A3\*

```{r, echo=FALSE}
ggplot(subset(df, method=='estimated' & measure %in% c('A1c', 'A2c', 'A3c')), aes(t_ms, value, colour=measure, linetype=script, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Filename, scales="free_x") + ggtitle("Estimated bandwidths")
```

\newpage
#### PraatSauce vs. VoiceSauce A1\*, A2\*, A3\*
```{r, echo=FALSE}
ggplot(subset(df, method == 'formula' & measure %in% c('A1c', 'A2c', 'A3c')), aes(t_ms, value, colour=measure, linetype=script, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Filename, scales="free_x") + ggtitle("Formula bandwidths")
```

\newpage
#### VoiceSauce estimated vs. formula bandwidths, A1\*, A2\*, A3\*

```{r, echo=FALSE}
ggplot(subset(df, script=='VoiceSauce' & measure %in% c('A1c', 'A2c', 'A3c')), aes(t_ms, value, colour=measure, linetype=method, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Filename, scales="free_x") 
```

\newpage
#### PraatSauce estimated vs. formula bandwidths, A1\*, A2\*, A3\*

```{r, echo=FALSE}
ggplot(subset(df, script=='PraatSauce' & measure %in% c('A1c', 'A2c', 'A3c')), aes(t_ms, value, colour=measure, linetype=method, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Filename, scales="free_x") 
```

\newpage
#### PraatSauce corrected vs. uncorrected

```{r, echo=FALSE}


ggplot(subset(df, script=='PraatSauce' & method=='estimated' & measure %in% c('H1u', 'H2u', 'H4u', 'H1c', 'H2c', 'H4c')), aes(t_ms, value, colour=measure, linetype=corrected, group=interaction(corrected,method,measure))) + geom_line() + facet_wrap(~Filename, scales="free_x") + scale_color_manual(values=c(c(hue_pal()(3)), c(hue_pal()(3)))) + ggtitle("Estimated bandwidths")

ggplot(subset(df, script=='PraatSauce' & method=='estimated' & measure %in% c('A1u', 'A2u', 'A3u', 'A1c', 'A2c', 'A3c')), aes(t_ms, value, colour=measure, linetype=corrected, group=interaction(corrected,method,measure))) + geom_line() + facet_wrap(~Filename, scales="free_x") + scale_color_manual(values=c(c(hue_pal()(3)), c(hue_pal()(3)))) + ggtitle("Formula bandwidths")
```

\newpage
#### VoiceSauce corrected vs. uncorrected

```{r, echo=FALSE}
ggplot(subset(df, script=='VoiceSauce' & method=='estimated' & measure %in% c('H1u', 'H2u', 'H4u', 'H1c', 'H2c', 'H4c')), aes(t_ms, value, colour=measure, linetype=corrected, group=interaction(corrected,method,measure))) + geom_line() + facet_wrap(~Filename, scales="free_x") + scale_color_manual(values=c(c(hue_pal()(3)), c(hue_pal()(3)))) + ggtitle("Estimated bandwidths")

ggplot(subset(df, script=='VoiceSauce' & method=='estimated' & measure %in% c('A1u', 'A2u', 'A3u', 'A1c', 'A2c', 'A3c')), aes(t_ms, value, colour=measure, linetype=corrected, group=interaction(corrected,method,measure))) + geom_line() + facet_wrap(~Filename, scales="free_x") + scale_color_manual(values=c(c(hue_pal()(3)), c(hue_pal()(3)))) + ggtitle("Formula bandwidths")
```

\newpage
### Corrected differences

#### PraatSauce vs. VoiceSauce H1\*-H2\* & H2\*-H4\*

```{r, echo=FALSE}
ggplot(subset(df, method == 'estimated' & measure %in% c('H1H2c', 'H2H4c')), aes(t_ms, value, colour=measure, linetype=script, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Filename, scales="free_x") +ggtitle("Estimated bandwidths")

ggplot(subset(df, method == 'formula' & measure %in% c('H1H2c', 'H2H4c')), aes(t_ms, value, colour=measure, linetype=script, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Filename, scales="free_x") + ggtitle("Formula bandwidths")
```

\newpage
##### PraatSauce vs. VoiceSauce H1\*-A1\*, A2\*, A3\*

```{r, echo=FALSE}
ggplot(subset(df, method=='estimated' & measure %in% c('H1A1c', 'H1A2c', 'H1A3c')), aes(t_ms, value, colour=measure, linetype=script, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Filename, scales='free_x') + ggtitle("Estimated bandwidths")

ggplot(subset(df, method=='formula' & measure %in% c('H1A1c', 'H1A2c', 'H1A3c')), aes(t_ms, value, colour=measure, linetype=script, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Filename, scales='free_x') + ggtitle("Formula bandwidths")
```

\newpage
### Cepstral peak prominence

```{r, echo=FALSE}
ggplot(subset(df, method=='formula' & measure=='CPP'), aes(t_ms, value, group=script, colour=script)) + geom_line() + facet_wrap(~Filename, scales='free_x')
```

Praat(Sauce) estimates are (roughly) comparable if smoothed.

\newpage
### Harmonic to noise ratios

Here just showing HNR05 and HNR15 for clarity.

```{r, echo=FALSE}
ggplot(subset(df, value>-10 & method=='formula' & measure %in% c('HNR05', 'HNR15')), aes(t_ms, value, group=interaction(measure,script), colour=measure, linetype=script)) + geom_line() + facet_wrap(~Filename, scales='free_x')
```

Again, the Praat estimates differ in amplitude, but maintain roughly the same trajectories. However, the PraatSauce implementation is much less sophisticated than that of VoiceSauce, and relies entirely on Praat's `To Harmonicity...` function.

\newpage
## Distinguishing voice qualities

```{r, include=FALSE}
is <- subset(df, Item %in% c('cig', 'cim', 'cug'))
as <- subset(df, Item %in% c('cab', 'cag', 'cam'))
```

### High vowels
```{r, echo=FALSE}
ggplot(subset(is, measure %in% c('H1H2c')), aes(t, value, colour=Item, linetype=method,  group=interaction(Item,measure,method))) + geom_line() + facet_wrap(~script, scales="free_x") + ggtitle("VoiceSauce vs. PraatSauce H1*-H2*")

ggplot(subset(is, measure %in% c('H1A1c')), aes(t, value, colour=Item, linetype=method,  group=interaction(Item,measure,method))) + geom_line() + facet_wrap(~script, scales="free_x") + ggtitle("VoiceSauce vs. PraatSauce H1*-A1*")

ggplot(subset(is, measure %in% c('H1A3c')), aes(t, value, colour=Item, linetype=method,  group=interaction(Item,measure,method))) + geom_line() + facet_wrap(~script, scales="free_x") + ggtitle("VoiceSauce vs. PraatSauce H1*-A3*")

ggplot(subset(is, measure %in% c('CPP')), aes(t, value, colour=Item, linetype=method,  group=interaction(Item,measure,method))) + geom_line() + facet_wrap(~script, scales="free_x") + ggtitle("VoiceSauce vs. PraatSauce CPP")
```

It would appear that neither procedure is correctly diagnosing `cug`, but inspection of the original audio recording suggests that this token is not realized with especially breathy voice. 


### Low vowels
```{r, echo=FALSE}
ggplot(subset(as, measure %in% c('H1H2c')), aes(t, value, colour=Item, linetype=method,  group=interaction(Item,measure,method))) + geom_line() + facet_wrap(~script, scales="free_x") + ggtitle("VoiceSauce vs. PraatSauce H1*-H2*")
ggplot(subset(as, measure %in% c('H1A1c')), aes(t, value, colour=Item, linetype=method,  group=interaction(Item,measure,method))) + geom_line() + facet_wrap(~script, scales="free_x") + ggtitle("VoiceSauce vs. PraatSauce H1*-A1*")
ggplot(subset(as, measure %in% c('H1A3c')), aes(t, value, colour=Item, linetype=method,  group=interaction(Item,measure,method))) + geom_line() + facet_wrap(~script, scales="free_x") + ggtitle("VoiceSauce vs. PraatSauce H1*-A3*")
ggplot(subset(as, measure %in% c('CPP')), aes(t, value, colour=Item, linetype=method, group=interaction(Item,measure,method))) + geom_line() + facet_grid(~script, scales="free_x") + ggtitle("VoiceSauce vs. PraatSauce CPP")
```

PraatSauce CPP values really need to be smoothed/binned.
