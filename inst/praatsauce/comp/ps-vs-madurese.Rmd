---
title: 'PraatSauce/VoiceSauce comparison: Madurese'
author: "James Kirby"
date: "31/01/2018"
output:
  pdf_document:
    toc: yes
    toc_depth: '3'
  html_document:
    toc: yes
    toc_depth: 3
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, cache = TRUE)
require(ggplot2)
require(plyr)
require(tidyr)
require(stringr)
library(scales)
theme_set(theme_bw())
```

```{r include=FALSE}

######################
## VoiceSauce 
######################

## VoiceSauce columns we care about
keeps <- c('Filename', 'Item', 'Gloss', 'seg_Start', 'seg_End', 't_ms', 'H1c', 'H2c', 'H4c', 'A1c', 'A2c', 'A3c', 'H1u', 'H2u', 'H4u', 'A1u', 'A2u', 'A3u', 'H2Ku', 'H5Ku', 'CPP', 'HNR05', 'HNR15', 'HNR25', 'HNR35', 'H1H2u', 'H2H4u', 'H1A1u', 'H1A2u', 'H1A3u', 'H1H2c', 'H2H4c', 'H1A1c', 'H1A2c', 'H1A3c', 'H2KH5Ku', 'strF0', 'sF0', 'pF0', 'sF1', 'sF2', 'sF3', 'pF1', 'pF2', 'pF3', 'pB1', 'pB2', 'pB3', 'sB1', 'sB2', 'sB3')

## Load VoiceSauce measures
vs.fbw <- read.csv('/Users/jkirby/Documents/Projects/praatsauce/comp/madurese_voicesauce_formulabw.txt', sep='\t')
## get rid of .mat extention
vs.fbw$Filename <- gsub('.mat', '', vs.fbw$Filename)
vs.fbw <- vs.fbw %>% separate(Filename, c("Item", "Gloss"), "-", remove=FALSE)
vs.fbw <- vs.fbw[keeps]
vs.fbw<-ddply(vs.fbw, .(Filename), mutate, t=rescale(t_ms))
vs.fbw$method = rep("formula")
vs.fbw$script = rep("VoiceSauce")
vs.fbw.long <- gather(vs.fbw, measure, value, H1c:sB3, factor_key=TRUE)        

vs.ebw <- read.csv('/Users/jkirby/Documents/Projects/praatsauce/comp/madurese_voicesauce_estbw.txt', sep='\t')
## get rid of .mat extention
vs.ebw$Filename <- gsub('.mat', '', vs.ebw$Filename)
vs.ebw <- vs.ebw %>% separate(Filename, c("Item", "Gloss"), "-", remove=FALSE)
vs.ebw <- vs.ebw[keeps]
vs.ebw<-ddply(vs.ebw, .(Filename), mutate, t=rescale(t_ms))
vs.ebw$method = rep("estimated")
vs.ebw$script = rep("VoiceSauce")
vs.ebw.long <- gather(vs.ebw, measure, value, H1c:sB3, factor_key=TRUE)        

######################
## PraatSauce
######################


## symmetric kernel
f21 <- rep(1/21,21)
## lag kernel
f20 <- rep(1/20,20)

ps.fbw <- read.csv('/Users/jkirby/Documents/Projects/praatsauce/comp/madurese_praatsauce_formulabw.txt', header=TRUE)
## turn into msec
ps.fbw$seg_Start <- ps.fbw$seg_Start * 1000
ps.fbw$seg_End <- ps.fbw$seg_End* 1000
ps.fbw$t_ms <- ps.fbw$t_ms* 1000
drops <- c('t', 'Label')
ps.fbw <- ps.fbw[, !(names(ps.fbw) %in% drops)]
names(ps.fbw)
names(ps.fbw) <- c('Filename', 'Item', 'Gloss', 'seg_Start', 'seg_End', 't_ms', 'pF0', 'pF1', 'pF2', 'pF3', 'pB1', 'pB2', 'pB3', 'H1u', 'H2u', 'H4u', 'H2Ku', 'H5Ku', 'A1u','A2u', 'A3u', 'H1H2u', 'H2H4u', 'H1A1u', 'H1A2u', 'H1A3u', 'H2KH5Ku', 'H1c', 'H2c', 'H4c', 'A1c', 'A2c', 'A3c', 'H1H2c', 'H2H4c', 'H1A1c', 'H1A2c', 'H1A3c', 'CPP', 'HNR05', 'HNR15', 'HNR25',  'HNR35')

## remove zeros
ps.fbw[ps.fbw == 0] <- NA

## smoothing
#ps.fbw <- cbind(ps.fbw[1:6], apply(ps.fbw[7:43], 2, filter, filter=f21, sides=2))

## scaled time
ps.fbw<-ddply(ps.fbw, .(Filename), mutate, t=rescale(t_ms))

ps.fbw$method = rep("formula")
ps.fbw$script = rep("PraatSauce")
ps.fbw.long <- gather(ps.fbw, measure, value, pF0:HNR35, factor_key=TRUE)

ps.ebw <- read.csv('/Users/jkirby/Documents/Projects/praatsauce/comp/madurese_praatsauce_estbw.txt', header=TRUE)
## turn into msec
ps.ebw$seg_Start <- ps.ebw$seg_Start * 1000
ps.ebw$seg_End <- ps.ebw$seg_End* 1000
ps.ebw$t_ms <- ps.ebw$t_ms* 1000
ps.ebw <- ps.ebw[, !(names(ps.ebw) %in% drops)]

names(ps.ebw) <- c('Filename', 'Item', 'Gloss', 'seg_Start', 'seg_End', 't_ms', 'pF0', 'pF1', 'pF2', 'pF3', 'pB1', 'pB2', 'pB3', 'H1u', 'H2u', 'H4u', 'H2Ku', 'H5Ku', 'A1u','A2u', 'A3u', 'H1H2u', 'H2H4u', 'H1A1u', 'H1A2u', 'H1A3u', 'H2KH5Ku', 'H1c', 'H2c', 'H4c', 'A1c', 'A2c', 'A3c', 'H1H2c', 'H2H4c', 'H1A1c', 'H1A2c', 'H1A3c', 'CPP', 'HNR05', 'HNR15', 'HNR25',  'HNR35')

## remove zero
ps.ebw[ps.ebw == 0] <- NA

## smooth
#ps.ebw <- cbind(ps.ebw[1:6], apply(ps.ebw[7:43], 2, filter, filter=f21, sides=2))

## scaled time
ps.ebw<-ddply(ps.ebw, .(Filename), mutate, t=rescale(t_ms))

ps.ebw$method = rep("estimated")
ps.ebw$script = rep("PraatSauce")
ps.ebw.long <- gather(ps.ebw, measure, value, pF0:HNR35, factor_key=TRUE)

## combine
df <- rbind(ps.fbw.long,ps.ebw.long,vs.fbw.long,vs.ebw.long)

df$corrected <- rep('uncorrected')
df[df$measure %in% c('H1c', 'H2c', 'H4c', 'A1c', 'A2c', 'A3c', 'H1H2c', 'H2H4c', 'H1A1c', 'H1A2c', 'H1A3c'),]$corrected <- 'corrected'

## remove centralized/geminate items
df <- droplevels(subset(df, !(Item %in% c('pesse', 'phisset', 'bisse'))))

## reorder
df$Item <- factor(df$Item, levels=c('baca', 'bisa', 'buta',  'phate', 'phitak', 'phuta', 'pada', 'perak', 'pote'))
```

## Data


This small dataset compares spectral measures generated by both PraatSauce v0.2.2 and VoiceSauce v1.31 at 1 msec intervals for 9 Madurese lexical items spoken by a single male speaker. (There are 12 items included, but here we set aside the centralised vowels for the time being.) The original audio files, included here, are from Misnadin and Kirby (forthcoming). For both scripts, 5 formants were estimated with a maximum formant frequency of 5000 Hz; minimum and maximum F0 values were set to 50 Hz and 300 Hz for all F0 estimators. For VoiceSauce, the STRAIGHT F0 estimate and Snack formant/bandwidth estimates were used for harmonic amplitude corrections.

The `method` column indicates whether the formant bandwidths were `estimated` using Praat (PraatSauce) or Snack (VoiceSauce), or whether the Hawks and Miller `formula` was used.

Madurese has a consonant-vowel co-occurrence restriction whereby vowels are organized into high/non-high pairs. The high member of each pair follows voiced and voiceless aspirated stops, while the non-high member follows the voiceless unaspirated member. The items analysed here represent exemplars of each vowel quality with a bilabial onset, in order to explore the effects of the spectral harmonic correction implementations.

```{r}
head(df)
```

In the plots which follow, the PraatSauce measures are unsmoothed. If you want to compare to smoothed estimates, uncomment the two lines:

```{r, execture=FALSE}
ps.fbw <- cbind(ps.fbw[1:6], apply(ps.fbw[7:43], 2, filter, filter=f21, sides=2))
ps.ebw <- cbind(ps.ebw[1:6], apply(ps.ebw[7:43], 2, filter, filter=f21, sides=2))
```

If you want to smooth the [Matlab way](#mfilter), use the lag kernel by selecting `filter=f20` and set `sides=1`.

## Plots

### F0

```{r, echo=FALSE}
ggplot(subset(df, value > 0 & method == 'formula' & measure %in% c('strF0', 'pF0', 'sF0')), aes(t, value, colour=measure, linetype=script, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Item, scales='free') 
```

It is not clear why VoiceSauce's pF0 (Praat) estimate differs so dramatically from the PraatSauce estimate, considering they should be using the same estimator with the same settings.

### Formants

```{r, echo=FALSE}
ggplot(subset(df, method == 'estimated' & measure %in% c('pF1', 'pF2', 'pF3')), aes(t, value, colour=measure, linetype=script, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Item, scales='free')
```


Compare with the VoiceSauce Snack estimates: 

```{r, echo=FALSE}
ggplot(subset(df, (script=='PraatSauce' & method == 'estimated' & measure %in% c('pF1', 'pF2', 'pF3')) | (script=='VoiceSauce' & method == 'estimated' & measure %in% c('sF1', 'sF2', 'sF3'))), aes(t, value, colour=measure, linetype=script, group=interaction(method,measure, script))) + geom_line() + facet_wrap(~Item, scales='free') + scale_color_manual(values=c(c(hue_pal()(3)), c(hue_pal()(3))))
```

\newpage
### Bandwidths

#### PraatSauce estimated vs. formula bandwidths 

```{r, echo=FALSE}
ggplot(subset(df, script=='PraatSauce' & measure %in% c('pB1', 'pB2', 'pB3')), aes(t, value, colour=measure, linetype=method, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Item, scales='free')
```

PraatSauce estimated bandwidths are huge...

\newpage
#### PraatSauce vs. VoiceSauce estimated bandwidths

```{r, echo=FALSE}

ggplot(subset(df, method == 'estimated' & measure %in% c('pB1', 'pB2', 'pB3')), aes(t, value, colour=measure, linetype=script, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Item, scales='free')
```

Here, both Praat-based estimators seem to be sync.

\newpage

\newpage
####  VoiceSauce Snack vs. PraatSauce estimated bandwidths 

```{r, echo=FALSE}
ggplot(subset(df, method == 'estimated' & (script=='PraatSauce' & measure %in% c('pB1', 'pB2', 'pB3')) | (script == 'VoiceSauce' & measure %in% c('sB1', 'sB2', 'sB3'))), aes(t, value, colour=measure, linetype=script, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Item, scales='free') + scale_color_manual(values=c(c(hue_pal()(3)), c(hue_pal()(3))))
```

PraatSauce estimates not completely off from Snack (if they really are Snack estimates).

\newpage
### Uncorrected amplitudes

#### PraatSauce vs. VoiceSauce H1, H2, H4
Note that the choice of bandwidth estimator is irrelevant here.

```{r, echo=FALSE}
ggplot(subset(df, method == 'formula' & measure %in% c('H1u', 'H2u', 'H4u')), aes(t, value, colour=measure, linetype=script, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Item, scales="free_x")
```

\newpage
#### PraatSauce vs. VoiceSauce A1-A3

```{r, echo=FALSE}
ggplot(subset(df, method == 'formula' & measure %in% c('A1u', 'A2u', 'A3u')), aes(t, value, colour=measure, linetype=script, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Item, scales='free_x') 
```

For reasons I have not been able to work out, PraatSauce estimates are consistently 20-25 dB higher than VoiceSauce estimates. This doesn't matter for the spectral differences, but it would be good to work out what the source of the difference is -- probably some kind of amplitude normalization/attenuation being done by VoiceSauce somewhere.

Note that the VoiceSauce estimates are sometimes negative, which seems...strange.

\newpage
### Corrected amplitudes

Here, choice of formant bandwidth estimator potentially matters.

In these plots, PraatSauce is using Praat and VoiceSauce is using Snack estimates.

#### PraatSauce vs. VoiceSauce H1\*, H2\*, H4\*

```{r, echo=FALSE}
ggplot(subset(df, method=='estimated' & measure %in% c('H1c', 'H2c', 'H4c')), aes(t, value, colour=measure, linetype=script, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Item, scales="free_x") +ggtitle("estimated bandwidths")
```

\newpage
#### PraatSauce vs. VoiceSauce H1\*, H2\*, H4\*
```{r, echo=FALSE}
ggplot(subset(df, method == 'formula' & measure %in% c('H1c', 'H2c', 'H4c')), aes(t, value, colour=measure, linetype=script, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Item, scales="free_x") +ggtitle("Formula bandwidths")
```

For VoiceSauce, no real difference can be observed:

\newpage
#### VoiceSauce estimated vs. formula bandwidths, H1\*, H2\*, H4\*

```{r, echo=FALSE}
ggplot(subset(df, script=='VoiceSauce' & measure %in% c('H1c', 'H2c', 'H4c')), aes(t, value, colour=measure, linetype=method, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Item, scales="free_x") 
```

For PraatSauce, using the formula bandwidths makes only minor differences:

\newpage
#### PraatSauce estimated vs. formula bandwidths, H1\*, H2\*, H4\*

```{r, echo=FALSE}
ggplot(subset(df, script=='PraatSauce' & measure %in% c('H1c', 'H2c', 'H4c')), aes(t, value, colour=measure, linetype=method, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Item, scales="free_x") 
```


\newpage
#### PraatSauce vs. VoiceSauce A1\*, A2\*, A3\*

```{r, echo=FALSE}
ggplot(subset(df, method=='estimated' & measure %in% c('A1c', 'A2c', 'A3c')), aes(t, value, colour=measure, linetype=script, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Item, scales="free_x") + ggtitle("Estimated bandwidths")
```

\newpage
#### PraatSauce vs. VoiceSauce A1\*, A2\*, A3\*
```{r, echo=FALSE}
ggplot(subset(df, method == 'formula' & measure %in% c('A1c', 'A2c', 'A3c')), aes(t, value, colour=measure, linetype=script, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Item, scales="free_x") + ggtitle("Formula bandwidths")
```

Again for VS the choice of bandwidth estimate doesn't seem to matter:

\newpage
#### VoiceSauce estimated vs. formula bandwidths, A1\*, A2\*, A3\*

```{r, echo=FALSE}
ggplot(subset(df, script=='VoiceSauce' & measure %in% c('A1c', 'A2c', 'A3c')), aes(t, value, colour=measure, linetype=method, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Item, scales="free_x") 
```

For PraatSauce things are less clear:

\newpage
#### PraatSauce estimated vs. formula bandwidths, A1\*, A2\*, A3\*

```{r, echo=FALSE}
ggplot(subset(df, script=='PraatSauce' & measure %in% c('A1c', 'A2c', 'A3c')), aes(t, value, colour=measure, linetype=method, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Item, scales="free_x") 
```

\newpage
#### PraatSauce corrected vs. uncorrected, H1/H2/H4, formula bandwidths

```{r, echo=FALSE}
ggplot(subset(df, script=='PraatSauce' & method=='formula' & measure %in% c('H1u', 'H2u', 'H4u', 'H1c', 'H2c', 'H4c')), aes(t, value, colour=measure, linetype=corrected, group=interaction(corrected,method,measure))) + geom_line() + facet_wrap(~Item, scales="free_x") + scale_color_manual(values=c(c(hue_pal()(3)), c(hue_pal()(3))))
```

Largest difference for H4.

\newpage
#### PraatSauce corrected vs. uncorrected, A1/A2/A3, formula bandwidths
```{r, echo=FALSE}
ggplot(subset(df, script=='PraatSauce' & method=='formula' & measure %in% c('A1u', 'A2u', 'A3u', 'A1c', 'A2c', 'A3c')), aes(t, value, colour=measure, linetype=corrected, group=interaction(corrected,method,measure))) + geom_line() + facet_wrap(~Item, scales="free_x") + scale_color_manual(values=c(c(hue_pal()(3)), c(hue_pal()(3))))
```

Largest differences for A1 and A2.

\newpage
#### PraatSauce corrected vs. uncorrected, H1/H2/H4, estimated bandwidths

```{r, echo=FALSE}
ggplot(subset(df, script=='PraatSauce' & method=='estimated' & measure %in% c('H1u', 'H2u', 'H4u', 'H1c', 'H2c', 'H4c')), aes(t, value, colour=measure, linetype=corrected, group=interaction(corrected,method,measure))) + geom_line() + facet_wrap(~Item, scales="free_x") + scale_color_manual(values=c(c(hue_pal()(3)), c(hue_pal()(3))))
```

\newpage
#### PraatSauce corrected vs. uncorrected, A1/A2/A3, estimated bandwidths
```{r, echo=FALSE}
ggplot(subset(df, script=='PraatSauce' & method=='estimated' & measure %in% c('A1u', 'A2u', 'A3u', 'A1c', 'A2c', 'A3c')), aes(t, value, colour=measure, linetype=corrected, group=interaction(corrected,method,measure))) + geom_line() + facet_wrap(~Item, scales="free_x") + scale_color_manual(values=c(c(hue_pal()(3)), c(hue_pal()(3))))
```

\newpage
#### VoiceSauce corrected vs. uncorrected, H1/H2/H4, formula bandwidths

```{r, echo=FALSE}
ggplot(subset(df, script=='VoiceSauce' & method=='formula' & measure %in% c('H1u', 'H2u', 'H4u', 'H1c', 'H2c', 'H4c')), aes(t, value, colour=measure, linetype=corrected, group=interaction(corrected,method,measure))) + geom_line() + facet_wrap(~Item, scales="free_x") + scale_color_manual(values=c(c(hue_pal()(3)), c(hue_pal()(3))))
```

\newpage
#### VoiceSauce corrected vs. uncorrected, A1/A2/A3, formula bandwidths
```{r, echo=FALSE}
ggplot(subset(df, script=='VoiceSauce' & method=='formula' & measure %in% c('A1u', 'A2u', 'A3u', 'A1c', 'A2c', 'A3c')), aes(t, value, colour=measure, linetype=corrected, group=interaction(corrected,method,measure))) + geom_line() + facet_wrap(~Item, scales="free_x") + scale_color_manual(values=c(c(hue_pal()(3)), c(hue_pal()(3))))
```

\newpage
### Corrected differences

More interesting is probably a comparison of the corrected differences:

#### PraatSauce vs. VoiceSauce estimated bandwidths, H1\*-H2\* & H2\*-H4\*

```{r, echo=FALSE}
ggplot(subset(df, method == 'estimated' & measure %in% c('H1H2c', 'H2H4c')), aes(t, value, colour=measure, linetype=script, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Item, scales="free_x") 
```

\newpage
#### PraatSauce vs. VoiceSauce formula bandwidths, H1\*-H2\* & H2\*-H4\*

```{r, echo=FALSE}
ggplot(subset(df, method == 'formula' & measure %in% c('H1H2c', 'H2H4c')), aes(t, value, colour=measure, linetype=script, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Item, scales="free_x") 
```

Very similar.

\newpage
#### PraatSauce vs. VoiceSauce: estimated bandwidths, H1\*-A1\*, A2\*, A3\*

```{r, echo=FALSE}
ggplot(subset(df, method=='estimated' & measure %in% c('H1A1c', 'H1A2c', 'H1A3c')), aes(t, value, colour=measure, linetype=script, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Item, scales='free')
```

\newpage
#### PraatSauce vs. VoiceSauce: formula bandwidths, H1\*-A1\*, A2\*, A3\*

```{r, echo=FALSE}
ggplot(subset(df, method=='formula' & measure %in% c('H1A1c', 'H1A2c', 'H1A3c')), aes(t, value, colour=measure, linetype=script, group=interaction(method,measure,script))) + geom_line() + facet_wrap(~Item, scales='free')
```

\newpage
### Cepstral peak prominence

```{r, echo=FALSE}
ggplot(subset(df, method=='formula' & measure=='CPP'), aes(t, value, group=script, colour=script)) + geom_line() + facet_wrap(~Item, scales='free_x')
```

Praat(Sauce) estimates are comparable if smoothed.

\newpage
### Harmonic to noise ratios

Here just showing HNR05 and HNR15 for clarity.

```{r, echo=FALSE}
ggplot(subset(df, value>-10 & method=='formula' & measure %in% c('HNR05', 'HNR15')), aes(t_ms, value, group=interaction(measure,script), colour=measure, linetype=script)) + geom_line() + facet_wrap(~Item, scales='free_x')
```

Again, the Praat estimates differ in amplitude, but maintain roughly the same trajectories. However, the PraatSauce implementation is much less sophisticated than that of VoiceSauce, and relies entirely on Praat's `To Harmonicity...` function. There does not appear to be much difference in the bands as PraatSauce estimates them.

\newpage
## Distinguishing vowel qualities

```{r, include=FALSE}
us <- subset(df, Item %in% c('buta', 'phuta', 'pote'))
is <- subset(df, Item %in% c('bisa', 'phitak', 'perak'))
as <- subset(df, Item %in% c('baca', 'phate', 'pada'))
```

### High/back vowels
```{r, echo=FALSE}
ggplot(subset(us, measure %in% c('H1H2c', 'H1H2u')), aes(t, value, colour=Item, linetype=method,  group=interaction(Item,measure,method))) + geom_line() + facet_wrap(~script+corrected, scales="free_x", labeller = label_wrap_gen(multi_line=FALSE)) + ggtitle("VoiceSauce vs. PraatSauce H1*-H2*")

ggplot(subset(us, measure %in% c('H1A1c', 'H1A1u')), aes(t, value, colour=Item, linetype=method,  group=interaction(Item,measure,method))) + geom_line() + facet_wrap(~script+corrected, scales="free_x", labeller = label_wrap_gen(multi_line=FALSE)) + ggtitle("VoiceSauce vs. PraatSauce H1*-A1*")

ggplot(subset(us, measure %in% c('H1A3c','H1A3u')), aes(t, value, colour=Item, linetype=method,  group=interaction(Item,measure,method))) + geom_line() + facet_wrap(~script+corrected, scales="free_x", labeller = label_wrap_gen(multi_line=FALSE)) + ggtitle("VoiceSauce vs. PraatSauce H1*-A3*")

ggplot(subset(us, measure %in% c('CPP')), aes(t, value, colour=Item, linetype=method,  group=interaction(Item,measure,method))) + geom_line() + facet_wrap(~script, scales="free_x") + ggtitle("VoiceSauce vs. PraatSauce CPP")
```

\newpage
### High/front vowels
```{r, echo=FALSE}
ggplot(subset(is, measure %in% c('H1H2c', 'H1H2u')), aes(t, value, colour=Item, linetype=method,  group=interaction(Item,measure,method))) + geom_line() + facet_wrap(~script+corrected, scales="free_x", labeller = label_wrap_gen(multi_line=FALSE)) + ggtitle("VoiceSauce vs. PraatSauce H1*-H2*")

ggplot(subset(is, measure %in% c('H1A1c', 'H1A1u')), aes(t, value, colour=Item, linetype=method,  group=interaction(Item,measure,method))) + geom_line() + facet_wrap(~script+corrected, scales="free_x", labeller = label_wrap_gen(multi_line=FALSE)) + ggtitle("VoiceSauce vs. PraatSauce H1*-A1*")

ggplot(subset(is, measure %in% c('H1A3c', 'H1A3u')), aes(t, value, colour=Item, linetype=method,  group=interaction(Item,measure,method))) + geom_line() + facet_wrap(~script+corrected, scales="free_x", labeller = label_wrap_gen(multi_line=FALSE)) + ggtitle("VoiceSauce vs. PraatSauce H1*-A3*")

ggplot(subset(is, measure %in% c('CPP')), aes(t, value, colour=Item, linetype=method,  group=interaction(Item,measure,method))) + geom_line() + facet_wrap(~script, scales="free_x") + ggtitle("VoiceSauce vs. PraatSauce CPP")
```

\newpage
### Low/front vowels
```{r, echo=FALSE}
ggplot(subset(as, measure %in% c('H1H2u', 'H1H2c')), aes(t, value, colour=Item, linetype=method,  group=interaction(Item,measure,method))) + geom_line() + facet_wrap(~script+corrected, scales="free_x", labeller = label_wrap_gen(multi_line=FALSE)) + ggtitle("VoiceSauce vs. PraatSauce H1*-H2*")

ggplot(subset(as, measure %in% c('H1A1c', 'H1A1u')), aes(t, value, colour=Item, linetype=method,  group=interaction(Item,measure,method))) + geom_line() + facet_wrap(~script+corrected, scales="free_x", labeller = label_wrap_gen(multi_line=FALSE)) + ggtitle("VoiceSauce vs. PraatSauce H1*-A1*")

ggplot(subset(as, measure %in% c('H1A3c', 'H1A3u')), aes(t, value, colour=Item, linetype=method,  group=interaction(Item,measure,method))) + geom_line() + facet_wrap(~script+corrected, scales="free_x",labeller = label_wrap_gen(multi_line=FALSE)) + ggtitle("VoiceSauce vs. PraatSauce H1*-A3*")

ggplot(subset(as, measure %in% c('CPP')), aes(t, value, colour=Item, linetype=method,  group=interaction(Item,measure,method))) + geom_line() + facet_wrap(~script, scales="free_x") + ggtitle("VoiceSauce vs. PraatSauce CPP")
```



